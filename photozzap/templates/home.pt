<!DOCTYPE html>
<html lang="en" ng-app="photozzap-home">
<head>
<title>Photozzap - Realtime Photo Sharing</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Bootstrap -->
<link href="${request.static_url('photozzap:static/bootstrap3/css/bootstrap.min.css')}" rel="stylesheet" media="screen">
<link href="${request.static_url('photozzap:static/bootstrap3/css/bootstrap-theme.min.css')}" rel="stylesheet" media="screen">
<script src="${request.static_url('photozzap:static/jquery/jquery-1.10.2.min.js')}"></script>
<script src="${request.static_url('photozzap:static/bootstrap3/js/bootstrap.min.js')}"></script>
<!-- angular and firebase -->
<script src="${request.static_url('photozzap:static/angular/angular.min.js')}"></script>
<script src="${request.static_url('photozzap:static/angular/ui-bootstrap-tpls-0.10.0.min.js')}"></script>
<script src="${request.static_url('photozzap:static/firebase/firebase.js')}"></script>
<script src="${request.static_url('photozzap:static/firebase/angularfire.min.js')}"></script>

    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }

      /* Custom container */
      .container-narrow {
        margin: 0 auto;
        max-width: 800px;
      }
      .container-narrow > hr {
        margin: 30px 0;
      }

      /* Main marketing message and sign up button */
      .jumbotron {
        margin-top: 5px;
        text-align: center;
      }
      .jumbotron h1 {
        font-size: 56px;
        line-height: 1;
      }
      .jumbotron .btn {
        font-size: 21px;
        padding: 14px 24px;
      }

      /* Supporting marketing content */
      .marketing {
        margin: 60px 0;
      }
      .marketing p + h4 {
        margin-top: 28px;
      }
      .container-narrow hr {
        margin-top: 3px;
        margin-bottom: 3px;
      }
      .likebox {
        text-align: center;
      }
      
    </style>
    
    <script>
   
    function randomString(length) {
        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz'.split('');

        if (! length) {
            length = Math.floor(Math.random() * chars.length);
        }

        var str = '';
        for (var i = 0; i < length; i++) {
            str += chars[Math.floor(Math.random() * chars.length)];
        }
        return str;
    }   
   
    var app = angular.module("photozzap-home", ["firebase", "ui.bootstrap"]);
    
    function PhotozzapHomeController($scope, $firebase, $modal, $log) { 
        
        $scope.open_add_conf_modal = function() {
            $scope.modalInstance = $modal.open({templateUrl: "create_conf_modal.html",
                                                controller: PhotozzapNewConfModalController});
        };
        
    }
    
    function PhotozzapNewConfModalController($scope, $modalInstance, $firebase, $log) {
        $scope.status = '';
    
        $scope.ok = function () {
            $scope.create_unique_conf_key($scope.confname);
        };
        
        $scope.create_unique_conf_key = function(confName) {
            var prefix = randomString(6);
            var confNameEncoded = confName.replace(/[^a-zA-Z0-9]/g, "-");
            var tentativeConfKey = prefix + "-" + confNameEncoded;
            var confRef = new Firebase("${firebase}conferences/" + tentativeConfKey);
            confRef.on('value', function(snapshot) {
                confRef.off('value');
                if(snapshot.val() === null) {
                    $log.info("conference " + tentativeConfKey + " does not exist, creating");
                    var conferencesRef = new Firebase("${firebase}conferences");
                    var newConf = conferencesRef.child(tentativeConfKey);
                    var conf_url = "${new_conf_url}".replace("new-conference-template", tentativeConfKey);
                    newConf.set({name: confName,
                                 url: conf_url});                    
                    $scope.status = "conference " + tentativeConfKey + " created";
                    $scope.$apply();
                } else {
                    $log.info("conference " + tentativeConfKey + " already exists, trying again");
                    $scope.create_unique_conf_key(confName);
                }
            });            
        };
       
        $scope.cancel = function () {
            $modalInstance.dismiss('cancel');
        };        
    }
    
    </script>   

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', '${tracking_id}', 'photozzap.com');
      ga('send', 'pageview');
    </script>
    
  </head>

  <body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=230215589885";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>  

   
    
    <div class="container">

      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="ma&#105;lto&#58;ph&#37;6Ft%6&#70;%7&#65;za&#112;%40&#109;a&#105;lc&#46;ne%74">Contact us</a></li>
        </ul>
        <h3 class="muted">Photozzap</h3>
      </div>

      <hr>
      <div class="row">
        <div class="col-md-8" ng-controller="PhotozzapHomeController">
            <script type="text/ng-template" id="create_conf_modal.html">
                <div class="modal-header">
                    <h3>Create new Photozzap Conference</h3>
                </div>
                <div class="modal-body">
                    <form role="form">
                        <div class="form-group">
                            <label for="confName">Conference Name</label>
                            <input type="text" name="confName" class="form-control" id="confName" ng-model="$parent.confname" placeholder="Enter a description, for example 'my photos'">
                        </div>
                    </form>
                </div>
                <span>status: {{status}}</span>
                <div class="modal-footer">
                    <button class="btn btn-primary" ng-click="ok()">OK</button>
                    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                </div>
            </script>        
          <div class="jumbotron">
            <h1>Real-time<br/>Photo Sharing</h1>
            <p class="lead">Upload photos. Invite your friends. Talk about photos together.</p>
            <a id='new-conf-button' class="btn btn-large btn-success" href="#" ng-click="open_add_conf_modal()">Start Conference</a>
            <div class="alert alert-block" style="margin-top: 10px; width: 200px; margin-left: auto; margin-right: auto;">
                <strong>Note:</strong> your conference will stay available for 7 days, after that it will be deleted.
            </div>
          </div>
        </div>
        <div class="col-md-4 likebox">
            <div class="fb-like-box" data-href="http://www.facebook.com/photozzap" data-width="280" data-colorscheme="light" data-show-faces="false" data-header="false" data-stream="true" data-show-border="false"></div>
        </div>              
      </div>

      <hr>

      <div class="row marketing">
        <div class="col-md-6">
          <h4>What's special about Photozzap ?</h4>
          <p>The number one feature is that you can <i>see</i> what photo your friends are looking at and <i>follow</i> them (or they can follow you). This makes it easier to discuss photos together over the Internet.</p>
          <h4>How do I use Photozzap ?</h4>
          <p><b>1.</b> Click the <b>Start Conference</b> button above. <b>2.</b> Upload photos. <b>3.</b> Copy/paste the URL and send it to your friends</p>
          <h4>Who can view my photos ?</h4>
          <p>Once you start the conference, you can share the URL with your friends. Only people who have this URL can 
          view your photos.</p>                  
        </div>
        <div class="col-md-6">
          <h4>Why should I use Photozzap instead of Picasa, Facebook, etc ?</h4>
          <p>Picasa, Facebook, Google+ are more suitable for complete albums with many photos. If you want to show 2 or 3 photos to friends or family right away, and view them together, maybe while having a Skype conference, Photozzap is more convenient.</p>
          <h4>Why did you make this?</h4>
          <p>There used to be a similar service called <a href="http://googlesystem.blogspot.hk/2008/05/picasas-hello-discontinued.html" target="_new">Picasa Hello</a>, which is
          now discontinued. For several years, there were no alternatives available.</p>
          <h4>I have a problem / suggestion</h4>
          <p><a href="ma&#105;lto&#58;ph&#37;6Ft%6&#70;%7&#65;za&#112;%40&#109;a&#105;lc&#46;ne%74">Contact us</a></p>
        </div>
        

      </div>

      <hr>

      <div class="footer">
        <p>&copy; Photozzap 2013</p>
      </div>

    </div> <!-- /container -->


</body>
</html>
