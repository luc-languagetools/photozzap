<!DOCTYPE html>
<html lang="en" ng-app="conferenceModule">
<head>
<title>Conference</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- google fonts -->
<link href='http://fonts.googleapis.com/css?family=Pathway+Gothic+One|Raleway:700' rel='stylesheet' type='text/css'>
<!-- css files -->
<link tal:repeat="file css_files" tal:attributes="href file" rel="stylesheet" media="screen">

<style type="text/css">
#loading-screen {
    z-index: 5; 
    position: fixed;
    left: 0%;
    top: 0%;    
    width: 100%;
    height: 100%;
    font-size: 32px; 
    color: #FFFFFF;
    background-color: #000000;
}
#loading-screen .loading-screen-content {
    margin-top: 30%;
    text-align: center;
}
#loading-screen .loading-screen-content p {
    margin-top: 20px;
}
#photozzap-title {
    font-size: 52px;
}
</style>

</head>
<body ng-controller="PhotozzapCtrl">
<script tal:repeat="file javascript_files" tal:attributes="src file" defer></script>

<script>
    var PHOTOZZAP_CONF_KEY = "${conf_key}";
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', '${tracking_id}', 'photozzap.com');
  ga('send', 'pageview');
</script>


<div id="upload-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="upload-modal-label" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="upload-modal-label">Upload Photo</h4>
            </div>
            <div class="modal-body">
                <div id="upload-controls" style="text-align: center;">
                    <div id="dragdrop_area" style="height: 150px; background-color: #DDDDDD; border-style: dashed; border-width: 3px;">
                        <h3 class="upload-header">Drag And Drop photos into this area</h3>
                        Or
                        <input name="file" type="file" class="cloudinary-fileupload" data-cloudinary-field="image_id"></input>
                    </div>
                    <div class="resize-controls">
                        <form>
                        <label class="radio">
                        <input type="radio" name="resizeOptions" value="option1" onclick="cloudinary_configure(true)" checked="checked">
                        Resize to 1024x768 (faster upload, lower quality)
                        </label>
                        <label class="radio">
                        <input type="radio" name="resizeOptions" value="option2" onclick="cloudinary_configure(false)">
                        Upload full image (slower upload, faster quality)
                        </label>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/ng-template" id="login_modal.html">
    <div class="modal-header">
        <h3>Login</h3>
    </div>
    <div class="modal-body">
        <alert ng-repeat="alert in alerts" type="alert.type" close="closeAlert($index)">{{alert.msg}}</alert>
        <form name="form.form" class="form-horizontal" role="form">
            <div class="form-group has-feedback" ng-class="{'has-error': form.form.nickname.$invalid, 'has-success': form.form.nickname.$valid}">
                <label class="control-label col-sm-4" for="nickname">Nickname
                    <small ng-show="form.form.nickname.$error.minlength"><br/>Min 3 characters</small>
                    <small ng-show="form.form.nickname.$error.maxlength"><br/>Max 30 characters</small>
                </label>
                <div class="col-sm-8">
                <input type="text" name="nickname" class="form-control" id="nickname" 
                  ng-model="user_object.nickname" 
                  ng-minlength="3"
                  ng-maxlength="30"
                  placeholder="Enter your nickname" required>
                <span class="glyphicon glyphicon-ok form-control-feedback" ng-class="{'glyphicon-ok': form.form.nickname.$valid, 'glyphicon-remove': form.form.nickname.$invalid}" ></span>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn btn-success btn-lg" ng-click="login()"  ng-disabled="form.form.$invalid">
            <span class="glyphicon glyphicon-ok"></span> Login</button>
        <button class="btn btn-default btn-lg" ng-click="cancel()">
            <span class="glyphicon glyphicon-remove"></span> Cancel</button>
    </div>
</script>  

<div id="main_image" ng-controller="ImageCtrl" ng-show="logged_in_and_ready" ng-cloak class="ng-cloak">
    <div id="displayed_image">
        <ul rn-carousel rn-carousel-buffered rn-carousel-control rn-carousel-index="global_data.photo_index" class="ng-cloak"
            ng-style="{'width': window_dimensions.width,
                       'height': window_dimensions.height}">
            <li class="image_layer_container" ng-repeat="image in sorted_images track by image.id">
                <div class="image_layer image_layer_top"
                ng-if="global_data.photo_state_by_id[image.id].photo_hires_url != undefined"
                ng-style="{'background-image': 'url(' + global_data.photo_state_by_id[image.id].photo_hires_url + ')'}">
                </div>
                <div class="image_layer image_layer_bottom"
                ng-style="{'background-image': 'url(' + global_data.photo_state_by_id[image.id].photo_url + ')'}">
                </div>                
            </li>        
        </ul>
    </div>
</div>

<div id="loading-screen" ng-hide="logged_in_and_ready">
    <div class="loading-screen-content">
        <span id="photozzap-title">Photozzap</span>
        <p id="connection-status-text">Please wait, 
            <span ng-hide="true">loading</span> <!-- gets displayed before angular kicks in -->
            <span ng-cloak class="ng-cloak">{{status_string}}</span> <!-- gets displayed after angular kicks in -->
        </p>
    </div>
</div>


<div class="container-fluid" ng-show="logged_in_and_ready" ng-cloak class="ng-cloak">
    <div class="row">
        <div class="col-md-12">
            <tabset>
                <tab  ng-controller="ThumbnailsCtrl" ng-init="init('sorted_images')" select="refresh_thumbnail_groups()">
                    <tab-heading>
                        <i class="glyphicon glyphicon-picture"></i> Photos
                    </tab-heading>
                    <div class="row">
                        <div class="col-md-12">
                            <ul rn-carousel rn-carousel-buffered rn-carousel-control rn-carousel-indicator rn-carousel-index="thumbnail_group_index" class="ng-cloak">
                                <li ng-repeat="group in thumbnail_groups track by group.id_list">
                                    <div class="thumbnail-container-tight" ng-style="{width: thumbnails_width + '%'}" ng-repeat="image in group.objs track by image.id">
                                        <a href="#" class="thumbnail-tight" ng-click="show_image(image.id)">
                                          <img ng-src="{{cloudinary_thumbnail_url(image.id)}}">
                                        </a>
                                    </div>
                                </li>        
                            </ul>
                        </div>
                    </div>            
                </tab>
                <tab ng-controller="ThumbnailsCtrl"  ng-init="init('sorted_images')" select="refresh_thumbnail_groups()">
                    <tab-heading>
                        <i class="glyphicon glyphicon-picture"></i> All Photos
                    </tab-heading>
                    <div class="row">
                        <div class="col-md-12">
                            <div ng-repeat="group in thumbnail_groups track by group.id_list">
                                <div class="thumbnail-container-tight" ng-style="{width: thumbnails_width + '%'}" ng-repeat="image in group.objs track by image.id">
                                    <a href="#" class="thumbnail-tight" ng-click="show_image(image.id)">
                                      <img ng-src="{{cloudinary_thumbnail_url(image.id)}}">
                                    </a>
                                </div>
                            </div>        
                        </div>
                    </div>                
                </tab>            
                <tab ng-controller="ThumbnailsCtrl" ng-init="init('sorted_users')" select="refresh_thumbnail_groups()">
                    <tab-heading>
                        <i class="glyphicon glyphicon-user"></i> Users
                    </tab-heading>
                    <div class="row">
                        <div class="col-md-12">
                            <ul rn-carousel rn-carousel-buffered rn-carousel-control rn-carousel-indicator  rn-carousel-index="thumbnail_group_index" class="ng-cloak">
                                <li ng-repeat="group in thumbnail_groups track by group.id_list">
                                    <div class="thumbnail-container-tight" ng-style="{width: thumbnails_width + '%'}" ng-repeat="user in group.objs track by user.id">
                                        <a href="#" class="thumbnail-tight" ng-click="show_image(user.viewing_image_id)">
                                          <img ng-src="{{cloudinary_thumbnail_url(user.viewing_image_id)}}">
                                          <br/>
                                          {{user.nickname}}
                                        </a>
                                    </div>
                                </li>        
                            </ul>
                        </div>
                    </div>  
                </tab> 
            </tabset>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-12">
            <tabset>
                <tab>
                    <tab-heading>
                        <i class="glyphicon glyphicon-comment"></i> Chat
                    </tab-heading>
                </tab>    
                <tab>
                    <tab-heading>
                        <i class="glyphicon glyphicon-cog"></i> Options
                    </tab-heading>
                    <button class="btn btn-primary btn-lg" ng-click="logout()">
                        Logout
                    </button>                    
                </tab> 
            </tabset>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-12">
            <button class="btn btn-primary btn-lg"  onclick="show_upload_modal();">
                Upload
            </button>
        </div>
    </div>

</div>



</body>
</html>